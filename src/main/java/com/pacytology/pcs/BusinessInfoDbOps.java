package com.pacytology.pcs;/*    PENNSYLVANIA CYTOLOGY SERVICES    LABORATORY INFORMATION SYSTEM V1.0    Copyright (C) 2001 by John Cardella    All Rights Reserved        File:       BusinessInfoDbOps.java    Created By: John Cardella, Software Engineer        Function:   Database operations for general     business information form.        MODIFICATIONS ----------------------------------    Date/Staff      Description:*/import java.lang.*;import java.sql.*;import java.util.Vector;public class BusinessInfoDbOps{    public BusinessInfoForm parent;    public BusinessInfoDbOps(BusinessInfoForm p) { parent=p; }    public boolean query()  {        boolean exitStatus=true;        try  {            String query =                 "SELECT \n"+                "   name,\n"+                           "   address1, \n"+                        "   address2, \n"+                         "   city, \n"+                "   state, \n"+                          "   zip, \n"+                  "   local_phone, \n"+                "   toll_free_phone, \n"+                "   fax, \n"+                          "   lab_director \n"+                              "FROM \n"+                "   pcs.business_info p \n";                            System.out.println(query);                            Statement stmt = DbConnection.process().createStatement();            ResultSet rs = stmt.executeQuery(query);            int rowsReturned=0;            while (rs.next()) {                rowsReturned++;                parent.businessName.setText(rs.getString(1));                parent.bAddress1.setText(rs.getString(2));                parent.bAddress2.setText(rs.getString(3));                parent.bCity.setText(rs.getString(4));                parent.bState.setText(rs.getString(5));                parent.bZip.setText(Utils.addZipMask(rs.getString(6)));                parent.bLocalPhone.setText(Utils.addPhoneMask(rs.getString(7)));                parent.bTollFreePhone.setText(Utils.addPhoneMask(rs.getString(8)));                parent.bFax.setText(Utils.addPhoneMask(rs.getString(9)));                parent.bLabDirector.setText(rs.getString(10));            }                   if (rowsReturned>0) {                 query =                    "SELECT id_code,id_number,id_description \n"+                    "FROM pcs.business_id_nums \n"+                    "ORDER BY id_code \n";                                    rs=stmt.executeQuery(query);                while (rs.next()) {                    parent.bData.addRow(rs.getString(1),rs.getString(2),rs.getString(3));                }            }            else {                exitStatus=false;                parent.msgLabel.setText("No Data Returned");            }        }        catch( Exception e ) {            System.out.println(e+" businessInfo.query");            exitStatus=false;            parent.msgLabel.setText("Operation Failed");        }        return(exitStatus);                }        public boolean update()  {        boolean exitStatus=true;        PreparedStatement pstmt;        try  {            String query =                 "UPDATE pcs.business_info SET \n"+                "   name = ?,\n"+                           "   address1 = ?, \n"+                        "   address2 = ?, \n"+                         "   city = ?, \n"+                "   state = ?, \n"+                          "   zip = ?, \n"+                  "   local_phone = ?, \n"+                "   toll_free_phone = ?, \n"+                "   fax = ?, \n"+                          "   lab_director = ? \n";                            pstmt = DbConnection.process().prepareStatement(query);            pstmt.setString(1,parent.businessName.getText());            pstmt.setString(2,parent.bAddress1.getText());            pstmt.setString(3,parent.bAddress2.getText());            pstmt.setString(4,parent.bCity.getText());            pstmt.setString(5,parent.bState.getText());            pstmt.setString(6,Utils.stripZipMask(parent.bZip.getText()));            pstmt.setString(7,Utils.stripPhoneMask(parent.bLocalPhone.getText()));            pstmt.setString(8,Utils.stripPhoneMask(parent.bTollFreePhone.getText()));            pstmt.setString(9,Utils.stripPhoneMask(parent.bFax.getText()));            pstmt.setString(10,parent.bLabDirector.getText());            pstmt.executeUpdate();        }        catch( Exception e ) {            System.out.println(e+" businessInfo.update");            exitStatus=false;            parent.msgLabel.setText("Operation Failed");        }        return(exitStatus);                }    public boolean addID()  {        boolean exitStatus=true;        PreparedStatement pstmt;        try  {            String query =                 "INSERT INTO pcs.business_id_nums (id_code,id_number,id_description) \n"+                "VALUES (?,?,?) \n";                                       pstmt = DbConnection.process().prepareStatement(query);            pstmt.setString(1,parent.idCode.getText());            pstmt.setString(2,parent.idNumber.getText());            pstmt.setString(3,parent.idDescr.getText());            pstmt.executeUpdate();        }        catch( Exception e ) {            System.out.println(e+" businessInfo.idAdd");            exitStatus=false;            parent.msgLabel.setText("Operation Failed");        }        return(exitStatus);                }    public boolean updateID()  {        boolean exitStatus=true;        PreparedStatement pstmt;        try  {            String query =                 "UPDATE pcs.business_id_nums \n"+                "SET id_number = ?, id_description = ? \n"+                "WHERE id_code = ? \n";                                       pstmt = DbConnection.process().prepareStatement(query);            pstmt.setString(3,parent.idCode.getText());            pstmt.setString(1,parent.idNumber.getText());            pstmt.setString(2,parent.idDescr.getText());            pstmt.executeUpdate();        }        catch( Exception e ) {            System.out.println(e+" businessInfo.idUpdate");            exitStatus=false;            parent.msgLabel.setText("Operation Failed");        }        return(exitStatus);                }    }
